/*! backbone.includes - v0.1.1 - 2014-03-26 */(function(e,t){"use strict";if("function"==typeof define&&define.amd)define("backbone.querybuilder",["backbone","underscore"],function(e,r){return t(e,r)});else if("undefined"!=typeof exports){var r=require("underscore"),i=require("backbone");module.exports=t(i,r)}else e.querybuilder=t(e.Backbone,e._)})(this,function(e,t){"use strict";var r={provider:null,setProvider:function(r){this.provider=r,t.extend(e.Model.prototype,i),t.extend(e.Collection.prototype,i)},getMixin:function(){return i}},i={includeRelated:function(){var e=[].slice.call(arguments),r=[];return t.each(e,function(e){r.push({field:e})}),this._rbQueryData=this._rbQueryData||{},this._rbQueryData.includeRelated=r,this},when:function(e){var r=[];return t.each(e,function(e,i){"string"==typeof e||"number"==typeof e?r.push({field:i,operator:"=",value:e}):"[object Array]"===toString.call(e)?r.push({field:i,operator:"in",value:e}):"object"==typeof e&&r.push({field:i,operator:t.keys(e)[0],value:t.values(e)[0]})}),this._rbQueryData=this._rbQueryData||{},this._rbQueryData.when=r,this},limit:function(e){return this._rbQueryData=this._rbQueryData||{},this._rbQueryData.limit=e,this},skip:function(e){return this._rbQueryData=this._rbQueryData||{},this._rbQueryData.skip=e,this},orderBy:function(e,r){var i,a;return"string"==typeof e?(i=e,a=r||"asc"):"object"==typeof e&&(i=t.keys(e)[0],a=t.values(e)[0]),this._rbQueryData=this._rbQueryData||{},this._rbQueryData.orderBy=this._rbQueryData.orderBy||[],this._rbQueryData.orderBy.push({field:i,direction:a}),this},sync:function(i,a,u){var n=r.provider.getFields(this._rbQueryData);return this._rbQueryData={},u.data=t.extend(n,u.data||{}),e.sync.call(this,i,a,u)}};return r});